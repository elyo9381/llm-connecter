ğŸ¤– AI ì±—ë´‡ í”„ë¡œì íŠ¸ ì™„ì „ ì¬í˜„ í”„ë¡¬í”„íŠ¸

ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”
Spring Boot 3.2.0 ê¸°ë°˜ì˜ ë‹¤ì¤‘ AI ì„œë¹„ìŠ¤ í†µí•© ì±—ë´‡ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•´ì£¼ì„¸ìš”. ì´ í”„ë¡œì íŠ¸ëŠ” Google Gemini, OpenAI, Claude APIë¥¼ í†µí•©í•˜ì—¬ ì‚¬ìš©ìê°€ ì„ íƒì ìœ¼ë¡œ AI ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

ğŸ—ï¸ ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜
- ì–¸ì–´: Java 21
- í”„ë ˆì„ì›Œí¬: Spring Boot 3.2.0
- ë¹Œë“œ ë„êµ¬: Gradle
- ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL 15 + Redis 7 (ìºì‹±)
- ë³´ì•ˆ: JWT ì¸ì¦/ì¸ê°€ + BCrypt ì•”í˜¸í™”
- ë°°í¬: Docker Compose (ë©€í‹° ì»¨í…Œì´ë„ˆ)
- API ë¬¸ì„œ: Swagger/OpenAPI 3
- ì•„í‚¤í…ì²˜ íŒ¨í„´: MVC + Factory Pattern + DDD (Domain Driven Design)

ğŸ“¦ íŒ¨í‚¤ì§€ êµ¬ì¡° (ë§¤ìš° ì¤‘ìš”!)
src/main/java/com/kafibara/chatbot/
â”œâ”€â”€ ChatbotApplication.java (ë©”ì¸ í´ë˜ìŠ¤)
â”œâ”€â”€ user/ (ì‚¬ìš©ì ë„ë©”ì¸ - 8ê°œ íŒŒì¼)
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ AuthController.java (íšŒì›ê°€ì…/ë¡œê·¸ì¸)
â”‚   â”‚   â””â”€â”€ UserController.java (ì‚¬ìš©ì ê´€ë¦¬)
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ UserService.java
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â””â”€â”€ User.java (JPA ì—”í‹°í‹°)
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ UserRepository.java
â”‚   â””â”€â”€ dto/
â”‚       â”œâ”€â”€ AuthResponse.java
â”‚       â”œâ”€â”€ LoginRequest.java
â”‚       â”œâ”€â”€ SignupRequest.java
â”‚       â””â”€â”€ UserResponse.java
â”œâ”€â”€ chat/ (ì±„íŒ… ë„ë©”ì¸ - 17ê°œ íŒŒì¼)
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ ChatController.java (ì±„íŒ… API)
â”‚   â”‚   â””â”€â”€ AIServiceController.java (AI ì„œë¹„ìŠ¤ ì •ë³´)
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ ChatService.java
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”œâ”€â”€ Chat.java (ì±„íŒ… ë©”ì‹œì§€)
â”‚   â”‚   â””â”€â”€ Thread.java (ì±„íŒ… ìŠ¤ë ˆë“œ)
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â”œâ”€â”€ ChatRepository.java
â”‚   â”‚   â””â”€â”€ ThreadRepository.java
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ ChatRequest.java
â”‚   â”‚   â”œâ”€â”€ ChatResponse.java
â”‚   â”‚   â””â”€â”€ AIServiceInfo.java
â”‚   â””â”€â”€ ai/ (AI ì„œë¹„ìŠ¤ í†µí•©)
â”‚       â”œâ”€â”€ AIService.java (ì¸í„°í˜ì´ìŠ¤)
â”‚       â”œâ”€â”€ AIServiceFactory.java (íŒ©í† ë¦¬ íŒ¨í„´)
â”‚       â”œâ”€â”€ ChatMessage.java (AI ë©”ì‹œì§€ DTO)
â”‚       â””â”€â”€ impl/
â”‚           â”œâ”€â”€ GeminiService.java (Google Gemini)
â”‚           â”œâ”€â”€ OpenAIService.java (ChatGPT)
â”‚           â”œâ”€â”€ ClaudeService.java (Anthropic Claude)
â”‚           â””â”€â”€ MockAIService.java (í…ŒìŠ¤íŠ¸ìš©)
â”œâ”€â”€ feedback/ (í”¼ë“œë°± ë„ë©”ì¸ - 10ê°œ íŒŒì¼)
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ FeedbackController.java
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ FeedbackService.java
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â””â”€â”€ Feedback.java
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ FeedbackRepository.java
â”‚   â””â”€â”€ dto/
â”‚       â”œâ”€â”€ FeedbackRequest.java
â”‚       â”œâ”€â”€ FeedbackResponse.java
â”‚       â”œâ”€â”€ FeedbackStatusUpdateRequest.java
â”‚       â””â”€â”€ FeedbackAnalyticsResponse.java
â””â”€â”€ config/ (ì„¤ì • ë° ê³µí†µ - 14ê°œ íŒŒì¼)
    â”œâ”€â”€ CacheConfig.java (Redis ìºì‹œ)
    â”œâ”€â”€ DataInitializer.java (ì´ˆê¸° ë°ì´í„°)
    â”œâ”€â”€ MetricsConfig.java (ëª¨ë‹ˆí„°ë§)
    â”œâ”€â”€ OpenApiConfig.java (Swagger)
    â”œâ”€â”€ SecurityConfig.java (Spring Security)
    â”œâ”€â”€ WebConfig.java (CORS ë“±)
    â”œâ”€â”€ admin/ (ê´€ë¦¬ì ê¸°ëŠ¥)
    â”‚   â”œâ”€â”€ AdminController.java
    â”‚   â”œâ”€â”€ AnalyticsService.java
    â”‚   â”œâ”€â”€ ReportService.java
    â”‚   â”œâ”€â”€ HealthController.java
    â”‚   â”œâ”€â”€ ActivityReportResponse.java
    â”‚   â””â”€â”€ ReportResponse.java
    â”œâ”€â”€ exception/
    â”‚   â””â”€â”€ GlobalExceptionHandler.java
    â””â”€â”€ util/
        â”œâ”€â”€ JwtAuthenticationFilter.java
        â””â”€â”€ JwtUtil.java

ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
-- users í…Œì´ë¸”
CREATE TABLE users (
    id BIGSERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    role VARCHAR(20) DEFAULT 'USER',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- threads í…Œì´ë¸” (ì±„íŒ… ìŠ¤ë ˆë“œ)
CREATE TABLE threads (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(id),
    title VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- chats í…Œì´ë¸” (ì±„íŒ… ë©”ì‹œì§€)
CREATE TABLE chats (
    id BIGSERIAL PRIMARY KEY,
    thread_id BIGINT REFERENCES threads(id),
    question TEXT NOT NULL,
    answer TEXT NOT NULL,
    ai_service VARCHAR(50) NOT NULL,
    follow_up_question TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- feedbacks í…Œì´ë¸”
CREATE TABLE feedbacks (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(id),
    chat_id BIGINT REFERENCES chats(id),
    is_positive BOOLEAN NOT NULL,
    comment TEXT,
    status VARCHAR(20) DEFAULT 'PENDING',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

ğŸ”§ ì£¼ìš” ì„¤ì • íŒŒì¼ë“¤

build.gradle
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
}

group = 'com.kafibara'
version = '0.0.1-SNAPSHOT'
java.sourceCompatibility = JavaVersion.VERSION_21

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-security'
    implementation 'org.springframework.boot:spring-boot-starter-data-redis'
    implementation 'org.springframework.boot:spring-boot-starter-webflux'
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'org.springframework.boot:spring-boot-starter-cache'
    
    // JWT
    implementation 'io.jsonwebtoken:jjwt-api:0.12.3'
    runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.12.3'
    runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.12.3'
    
    // Database
    runtimeOnly 'org.postgresql:postgresql'
    
    // Documentation
    implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.2.0'
    
    // Lombok
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'
    
    // Test
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.springframework.security:spring-security-test'
}

application.yml (í”„ë¡œíŒŒì¼ë³„ ì„¤ì •)
# application.yml (ê¸°ë³¸)
spring:
  profiles:
    active: demo
  application:
    name: custom-chatbot
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
  cache:
    type: redis
  data:
    redis:
      host: localhost
      port: 6379

logging:
  level:
    com.kafibara.chatbot: DEBUG

# AI Service API Keys (í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬)
ai:
  gemini:
    api-key: ${GEMINI_API_KEY:}
    base-url: https://generativelanguage.googleapis.com
  openai:
    api-key: ${OPENAI_API_KEY:}
    base-url: https://api.openai.com
  claude:
    api-key: ${CLAUDE_API_KEY:}
    base-url: https://api.anthropic.com

jwt:
  secret: ${JWT_SECRET:your-secret-key-here-make-it-long-and-secure}
  expiration: 86400000 # 24ì‹œê°„

docker-compose.yml
version: '3.8'
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: chatbot
      POSTGRES_USER: chatbot
      POSTGRES_PASSWORD: chatbot123
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  app:
    build: .
    ports:
      - "8080:8080"
    environment:
      SPRING_PROFILES_ACTIVE: docker
      SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/chatbot
      SPRING_DATASOURCE_USERNAME: chatbot
      SPRING_DATASOURCE_PASSWORD: chatbot123
      SPRING_DATA_REDIS_HOST: redis
      GEMINI_API_KEY: ${GEMINI_API_KEY}
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      CLAUDE_API_KEY: ${CLAUDE_API_KEY}
      JWT_SECRET: ${JWT_SECRET}
    depends_on:
      - postgres
      - redis
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  postgres_data:

ğŸ”‘ í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ ìš”êµ¬ì‚¬í•­

1. ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ
- JWT ê¸°ë°˜ ì¸ì¦/ì¸ê°€
- íšŒì›ê°€ì…/ë¡œê·¸ì¸ API
- BCrypt íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”
- Role ê¸°ë°˜ ê¶Œí•œ ê´€ë¦¬ (USER, ADMIN)

2. AI ì„œë¹„ìŠ¤ í†µí•©
- Factory Patternìœ¼ë¡œ AI ì„œë¹„ìŠ¤ ì„ íƒ
- Google Gemini, OpenAI, Claude API í†µí•©
- ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì§€ì› (Server-Sent Events)
- Mock ì„œë¹„ìŠ¤ (í…ŒìŠ¤íŠ¸ìš©)

3. ì±„íŒ… ì‹œìŠ¤í…œ
- ìŠ¤ë ˆë“œ ê¸°ë°˜ ëŒ€í™” ê´€ë¦¬
- ëŒ€í™” íˆìŠ¤í† ë¦¬ ì €ì¥
- í›„ì† ì§ˆë¬¸ ìë™ ìƒì„±
- í˜ì´ì§€ë„¤ì´ì…˜ ì§€ì›

4. í”¼ë“œë°± ì‹œìŠ¤í…œ
- ê¸ì •/ë¶€ì • í”¼ë“œë°±
- ìƒíƒœ ê´€ë¦¬ (PENDING, RESOLVED)
- ë¶„ì„ ë° í†µê³„ ê¸°ëŠ¥

5. ê´€ë¦¬ì ê¸°ëŠ¥
- ì‚¬ìš©ì ê´€ë¦¬
- ì‹œìŠ¤í…œ ë¶„ì„ ë° ë³´ê³ ì„œ
- í”¼ë“œë°± ê´€ë¦¬
- í—¬ìŠ¤ì²´í¬

ğŸ”’ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- API í‚¤ëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬
- CORS ì„¤ì •
- SQL Injection ë°©ì§€
- XSS ë°©ì§€

ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…
- Spring Boot Actuator
- Redis ìºì‹±
- ìƒì„¸í•œ ë¡œê¹… ì„¤ì •
- í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸

ğŸ³ ë°°í¬ í™˜ê²½
- Docker ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ
- PostgreSQL + Redis + App ì»¨í…Œì´ë„ˆ
- í™˜ê²½ë³„ í”„ë¡œíŒŒì¼ (demo, docker, test)
- í—¬ìŠ¤ì²´í¬ ë° ì˜ì¡´ì„± ê´€ë¦¬

ğŸ“ API ë¬¸ì„œí™”
- Swagger/OpenAPI 3 í†µí•©
- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ë¬¸ì„œí™”
- DTO ìŠ¤í‚¤ë§ˆ ì •ì˜
- ì¸ì¦ ìš”êµ¬ì‚¬í•­ ëª…ì‹œ

ğŸ§ª í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (JUnit 5)
- í†µí•© í…ŒìŠ¤íŠ¸
- Security í…ŒìŠ¤íŠ¸
- Mock ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

ğŸ“ ì¶”ê°€ íŒŒì¼ë“¤
- .env.example (í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿)
- init-db.sql (ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”)
- Dockerfile (ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ)
- README.md (í•œêµ­ì–´ ë¬¸ì„œ)
- .gitignore (Java/Spring Boot í‘œì¤€)

ğŸ¯ ì¤‘ìš”í•œ êµ¬í˜„ í¬ì¸íŠ¸
1. íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ì •í™•íˆ ì§€ì¼œì£¼ì„¸ìš” - DDD íŒ¨í„´ ì ìš©
2. ëª¨ë“  import ë¬¸ì´ ìƒˆë¡œìš´ íŒ¨í‚¤ì§€ êµ¬ì¡°ì— ë§ê²Œ ì„¤ì •ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
3. AI ì„œë¹„ìŠ¤ëŠ” Factory Patternìœ¼ë¡œ êµ¬í˜„
4. JWT ì¸ì¦ì€ í•„í„° ì²´ì¸ì— ì •í™•íˆ ì„¤ì •
5. Docker í™˜ê²½ì—ì„œ ì •ìƒ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤
6. Redis ìºì‹±ì´ ì ìš©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
7. ëª¨ë“  APIëŠ” Swaggerë¡œ ë¬¸ì„œí™”
8. í•œêµ­ì–´ ì£¼ì„ ë° ë¬¸ì„œ ì‘ì„±

ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œë„ ë™ì¼í•œ í”„ë¡œì íŠ¸ë¥¼ ì™„ì „íˆ ì¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ íŒ¨í‚¤ì§€ êµ¬ì¡°ì™€ ì˜ì¡´ì„± ê´€ê³„ê°€ ë§¤ìš° ì¤‘ìš”í•˜ë¯€ë¡œ ì •í™•íˆ ë”°ë¼ì£¼ì„¸ìš”.
